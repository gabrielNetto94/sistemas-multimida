<!DOCTYPE HTML>
<html>
	<head>		
		<meta charset="utf-8">
		<link rel = "stylesheet" type = "text/css" href = "style.css" />
		<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
	</head>
  <body>
  	<script type="text/javascript" src="js.js"></script>
	<canvas id="myCanvas" width="700" height="450"></canvas><br>
	
	<h3>Cor pincel</h3>
	<button onclick="changeColor('#ff0000')" class="btn btn-danger">Red</button>
	<button onclick="changeColor('#00ff00')" class="btn btn-success">Green</button>
	<button onclick="changeColor('#0000ff')" class="btn btn-primary">Blue</button>
	<button onclick="useBrush()" class="btn btn-dark">Pincel</button>
	<button onclick="useEraser()">Borracha</button>

	<h3>Tamanho traço</h3>
	<input id="slider" type="range" min="1" max="50" value="25" class="slider" id="myRange">
	<output id="output"></output>
	<button onclick="changeLineSize()">slider</button>
	
	<h3>Desenhar Linhas</h3>
	<button onclick="drawLine()" class="btn btn-dark">Linha</button>
		
	<h3>Cor de fundo canvas</h3>
	<input id="inputColor" type="color" name="favcolor" value="#ff0000">
	<button onclick="changeBackgroundColorCanvas()" class="btn btn-dark">background</button>

	<input type="checkbox" id="kare"><label for="kare">Kare</label>

  </body>
  <script type="text/javascript">
	/*
	OK a) desenho livre, com troca do tamanho do traço 
	b) desenho de pelo menos 3 formas geométricas, podendo escolher a cor da linha e de preenchimento e a largura da linha
	c) desenho de linhas, podendo escolher a cor da linha e a largura da mesma
 	OK d) troca de cores, tanto para o desenho quanto para o fundo
	OK e) borracha
	*/

	//BEGIN TEST
	var kareMi = false;

	//END TEST

	var canvas = document.getElementById("myCanvas");
	var ctx = canvas.getContext("2d");
	var slider = document.getElementById("#slider");

	var isPressed = false;
	
	var eraser = {
		colorEraser: "#ffffff",
		use: false
	}		
	
	ctx.lineCap  = "round";

	//TEST	
	var startPointX = 0;
	var startPointY = 0;
	//END TEST
	
	canvas.onmousedown = function(event){
		isPressed = true;
		ctx.moveTo(event.clientX, event.clientY);

		//BEGIN TEST
		kareMi = document.getElementById("kare").checked;
		startPointX = event.pageX;
		startPointY = event.pageY;
		ctx.beginPath();
		ctx.moveTo(startPointX, startPointY);
		//END TEST
	}
	
	canvas.onmouseup = function (event){
		isPressed = false;
		ctx.beginPath();
		
		//BEGIN TEST
		if(kareMi){
			//canvas.width = canvas.width;
			var width = event.offsetX - startPointX;
			var height = event.offsetY - startPointY;
			//ctx.fillRect(startPointX, startPointY, width, height);
			ctx.strokeRect(startPointX, startPointY, width, height);
			ctx.beginPath();
		}
		//END TEST
	}

	canvas.onmousemove = function(event){
		if(kareMi){
				var width = event.offsetX - startPointX;
				var height = event.offsetY - startPointY;
				ctx.strokeRect(startPointX, startPointY, width, height);
			}else{
			if(isPressed){				
			// ctx.lineTo(event.pageX, event.pageY);
				ctx.lineTo(event.clientX, event.clientY);
				ctx.stroke();
			}
		}
	}

	function changeBackgroundColorCanvas(){
		var colorInput = document.getElementById("inputColor").value;
		canvas.style.backgroundColor = colorInput;
		eraser.colorEraser = colorInput;
		//ctx.strokeStyle = colorEraser;//change color eraser
	}

	function changeLineSize() {
	   var val = document.getElementById("slider").value //gets the oninput value
	   document.getElementById('output').innerHTML = val //displays this value to the html page
	   ctx.lineWidth = val;
	}

	function changeColor(color){	
		ctx.strokeStyle = color;
	}

	function useEraser(){
		
		ctx.strokeStyle = eraser.colorEraser;
	}

	function useBrush(){
		ctx.strokeStyle = "#000000";
	}

  </script>
</html> 